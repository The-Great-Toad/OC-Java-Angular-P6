<div class="container--auth">

    <app-back-button></app-back-button>

    <div class="card card--auth">
        <h1>Inscription</h1>

        @if (errorMessage()) {
        <app-error-state [message]="errorMessage()!"></app-error-state>
        }

        <form [formGroup]="registerForm" (ngSubmit)="onSubmit()">
            <!-- Username -->
            <div class="form-group">
                <label for="username">Nom d'utilisateur</label>
                <input type="text" id="username" formControlName="username"
                       placeholder="Choisissez un nom d'utilisateur"
                       [class.invalid]="username?.invalid && username?.touched" />
                @if (username?.invalid && username?.touched) {
                <span class="error">Le nom d'utilisateur est requis</span>
                }
            </div>

            <!-- Email -->
            <div class="form-group">
                <label for="email">Email</label>
                <input type="email" id="email" formControlName="email"
                       placeholder="Entrez votre email"
                       [class.invalid]="email?.invalid && email?.touched" />
                @if (email?.invalid && email?.touched) {
                <span class="error">
                    @if (email?.errors?.['required']) {
                    L'email est requis
                    }
                    @if (email?.errors?.['email']) {
                    L'email n'est pas valide
                    }
                </span>
                }
            </div>

            <!-- Password -->
            <div class="form-group">
                <label for="password">Mot de passe</label>
                <input type="password" id="password" formControlName="password"
                       placeholder="Choisissez un mot de passe"
                       [class.invalid]="password?.invalid && password?.touched" />

                <!-- Password Requirements - Affiché dès que l'utilisateur tape -->
                @if (password?.value) {
                <app-password-requirements
                                           [passwordErrors]="passwordErrors"></app-password-requirements>
                }
            </div>

            <div class="flex flex--center">
                <button type="submit" class="btn btn-primary"
                        [disabled]="registerForm.invalid || isLoading()">
                    @if (isLoading()) {
                    Inscription en cours...
                    } @else {
                    S'inscrire
                    }
                </button>
            </div>
        </form>
    </div>
</div>